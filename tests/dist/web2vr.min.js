!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("aframe")):"function"==typeof define&&define.amd?define(["aframe"],e):"object"==typeof exports?exports.Web2VR=e(require("aframe")):t.Web2VR=e(t.aframe)}(self,(t=>(()=>{var e={481:()=>{!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,n.c=e,n.p="",n(0)}([function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i=n(1);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var o=AFRAME.utils.srcLoader.parseUrl,a=AFRAME.utils.debug;a.enable("shader:gif:warn");var s=a("shader:gif:warn"),l=a("shader:gif:debug"),c={};function u(t,e){return{status:"error",src:e,message:t,timestamp:Date.now()}}AFRAME.registerShader("gif",{schema:{color:{type:"color"},fog:{default:!0},src:{default:null},autoplay:{default:!0}},init:function(t){return l("init",t),l(this.el.components),this.__cnv=document.createElement("canvas"),this.__cnv.width=2,this.__cnv.height=2,this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),this.__material={},this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.__addPublicFunctions(),this.material},update:function(t){return l("update",t),this.__updateMaterial(t),this.__updateTexture(t),this.material},tick:function(t){this.__frames&&!this.paused()&&Date.now()-this.__startTime>=this.__nextFrameTime&&this.nextFrame()},__updateMaterial:function(t){var e=this.material,n=this.__getMaterialData(t);Object.keys(n).forEach((function(t){e[t]=n[t]}))},__getMaterialData:function(t){return{fog:t.fog,color:new THREE.Color(t.color)}},__setTexure:function(t){l("__setTexure",t),"error"===t.status?(s("Error: "+t.message+"\nsrc: "+t.src),this.__reset()):"success"===t.status&&t.src!==this.__textureSrc&&(this.__reset(),this.__ready(t))},__updateTexture:function(t){var e=t.src,n=t.autoplay;"boolean"==typeof n?this.__autoplay=n:void 0===n&&(this.__autoplay=!0),this.__autoplay&&this.__frames&&this.play(),e?this.__validateSrc(e,this.__setTexure.bind(this)):this.__reset()},__validateSrc:function(t,e){var n=o(t);if(n)this.__getImageSrc(n,e);else{var i=void 0,a=this.__validateAndGetQuerySelector(t);if(a&&"object"===(void 0===a?"undefined":r(a))){if(a.error)i=a.error;else{var s=a.tagName.toLowerCase();if("video"===s)t=a.src,i="For video, please use `aframe-video-shader`";else{if("img"===s)return void this.__getImageSrc(a.src,e);i="For <"+s+"> element, please use `aframe-html-shader`"}}var l,d;i&&(l=c[t],d=u(i,t),l&&l.callbacks?l.callbacks.forEach((function(t){return t(d)})):e(d),c[t]=d)}}},__getImageSrc:function(t,e){var n=this;if(t!==this.__textureSrc){var r=c[t];if(r&&r.callbacks){if(r.src)return void e(r);if(r.callbacks)return void r.callbacks.push(e)}else(r=c[t]={callbacks:[]}).callbacks.push(e);var o=new Image;o.crossOrigin="Anonymous",o.addEventListener("load",(function(e){n.__getUnit8Array(t,(function(e){e?(0,i.parseGIF)(e,(function(e,n,i){var o={status:"success",src:t,times:e,cnt:n,frames:i,timestamp:Date.now()};r.callbacks&&(r.callbacks.forEach((function(t){return t(o)})),c[t]=o)}),(function(t){return a(t)})):a("This is not gif. Please use `shader:flat` instead")}))})),o.addEventListener("error",(function(t){return a("Could be the following issue\n - Not Image\n - Not Found\n - Server Error\n - Cross-Origin Issue")})),o.src=t}function a(e){var n=u(e,t);r.callbacks&&(r.callbacks.forEach((function(t){return t(n)})),c[t]=n)}},__getUnit8Array:function(t,e){if("function"==typeof e){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="arraybuffer",n.addEventListener("load",(function(t){for(var n=new Uint8Array(t.target.response),r=n.subarray(0,4),i="",o=0;o<r.length;o++)i+=r[o].toString(16);"47494638"===i?e(n):e()})),n.addEventListener("error",(function(t){l(t),e()})),n.send()}},__validateAndGetQuerySelector:function(t){try{return document.querySelector(t)||{error:"No element was found matching the selector"}}catch(t){return{error:"no valid selector"}}},__addPublicFunctions:function(){this.el.gif={play:this.play.bind(this),pause:this.pause.bind(this),togglePlayback:this.togglePlayback.bind(this),paused:this.paused.bind(this),nextFrame:this.nextFrame.bind(this)}},pause:function(){l("pause"),this.__paused=!0},play:function(){l("play"),this.__paused=!1},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},nextFrame:function(){for(this.__draw();Date.now()-this.__startTime>=this.__nextFrameTime;)this.__nextFrameTime+=this.__delayTimes[this.__frameIdx++],(this.__infinity||this.__loopCnt)&&this.__frameCnt<=this.__frameIdx&&(this.__frameIdx=0)},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__draw:function(){this.__ctx.drawImage(this.__frames[this.__frameIdx],0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__ready:function(t){var e=t.src,n=t.times,r=t.cnt,i=t.frames;l("__ready"),this.__textureSrc=e,this.__delayTimes=n,r?this.__loopCnt=r:this.__infinity=!0,this.__frames=i,this.__frameCnt=n.length,this.__startTime=Date.now(),this.__width=THREE.Math.floorPowerOfTwo(i[0].width),this.__height=THREE.Math.floorPowerOfTwo(i[0].height),this.__cnv.width=this.__width,this.__cnv.height=this.__height,this.__draw(),this.__autoplay?this.play():this.pause()},__reset:function(){this.pause(),this.__clearCanvas(),this.__startTime=0,this.__nextFrameTime=0,this.__frameIdx=0,this.__frameCnt=0,this.__delayTimes=null,this.__infinity=!1,this.__loopCnt=0,this.__frames=null,this.__textureSrc=null}})},function(t,e){"use strict";e.parseGIF=function(t,e,n){var r=0,i=[],o=0,a=null,s=null,l=[],c=0;if(71===t[0]&&73===t[1]&&70===t[2]&&56===t[3]&&57===t[4]&&97===t[5]){r+=13+ +!!(128&t[10])*Math.pow(2,1+(7&t[10]))*3;for(var u=t.subarray(0,r);t[r]&&59!==t[r];){var d=r,h=t[r];if(33===h){var f=t[++r];if(-1===[1,254,249,255].indexOf(f)){n&&n("parseGIF: unknown label");break}for(249===f&&i.push(10*(t[r+3]+(t[r+4]<<8))),255===f&&(c=t[r+15]+(t[r+16]<<8));t[++r];)r+=t[r];249===f&&(a=t.subarray(d,r+1))}else{if(44!==h){n&&n("parseGIF: unknown blockId");break}for(r+=9,r+=1+ +!!(128&t[r])*(3*Math.pow(2,1+(7&t[r])));t[++r];)r+=t[r];s=t.subarray(d,r+1),l.push(URL.createObjectURL(new Blob([u,a,s])))}r++}}else n&&n("parseGIF: no GIF89a");if(l.length){var p=document.createElement("canvas"),y=function t(n){var r=new Image;r.onload=function(n,r){o++,l[r]=this,o===l.length?(p=null,e&&e(i,c,l)):t(++r)}.bind(r),r.src=p.toDataURL("image/gif")};l.forEach((function(t,e){var n=new Image;n.onload=function(t,e){0===e&&(p.width=n.width,p.height=n.height),o++,l[e]=this,o===l.length&&(o=0,y())}.bind(n,null,e),n.src=t}))}}}])},157:()=>{AFRAME.registerComponent("vr-animate",{init:function(){this.running=!1,this.el.element.domElement.addEventListener("animationstart",this.startAnimation.bind(this)),this.el.element.domElement.addEventListener("animationend",this.stopAnimation.bind(this)),this.el.element.domElement.addEventListener("transitionstart",this.startAnimation.bind(this)),this.el.element.domElement.addEventListener("transitionend",this.stopAnimation.bind(this))},tick:function(){this.running&&this.el.element.web2vr.update()},startAnimation:function(){this.running=!0},stopAnimation:function(){this.running=!1,this.el.element.web2vr.update()}})},979:()=>{AFRAME.registerComponent("vr-border",{schema:{width:{type:"number"},color:{type:"string"}},init:function(){this.running=!0;var t=this.el.object3D.children[0],e=new THREE.EdgesGeometry(t.geometry),n=new THREE.LineSegments(e,new THREE.LineBasicMaterial({color:0,linewidth:this.data.width}));this.borderObject=n,this.el.element.web2vr.aframe.container.object3D.add(this.borderObject),this.el.element.clippingContext&&(n.material.clippingPlanes=this.el.element.clippingContext.planes,n.material.needsUpdate=!0)},update:function(){var t=this.data.width;this.el.element.borderWidth?this.borderObject.material.linewidth=this.el.element.borderWidth:this.borderObject.material.linewidth=t,this.el.element.borderColor?this.borderObject.material.color=this.el.element.borderColor:this.borderObject.material.color=new THREE.Color(this.data.color)},updateBorder:function(){this.el.element.visible?(this.running=!0,this.borderObject.material.visible=!0):this.borderObject.material.visible=!1},tick:function(){if(this.running){var t=this.el.object3D.scale,e=this.el.object3D.children[0].geometry.clone();e.scale(t.x,t.y,t.z);var n=new THREE.EdgesGeometry(e),r=this.el.object3D.position;this.borderObject.geometry=n,this.borderObject.position.set(r.x,r.y,r.z+2*this.el.element.web2vr.settings.layerStep),this.running=!1}},remove:function(){this.el.element.web2vr.aframe.container.object3D.remove(this.borderObject)}})},938:()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}AFRAME.registerComponent("vr-grab-rotate-static",{tick:function(){if(this.el.components.grabbable.grabbed){if(this.el.web2vr.scroll.hasScroll){var e,n=function(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}(this.el.web2vr.elements);try{for(n.s();!(e=n.n()).done;)e.value.updateClipping()}catch(t){n.e(t)}finally{n.f()}}var r=this.el.object3D,i=this.el.components.grabbable.grabbers[0].object3D;r.rotation.y=Math.atan2(i.position.x-(r.position.x+this.el.children[0].getAttribute("width")/2),i.position.z-r.position.z)}}})},953:()=>{AFRAME.registerComponent("vr-renderer",{init:function(){this.el.sceneEl.renderer.localClippingEnabled=!0}})},971:()=>{function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}AFRAME.registerComponent("vr-scrollbar",{init:function(){this.el.addEventListener("click",function(n){var r=parseFloat(this.el.web2vr.aframe.container.firstElementChild.element.style.height)-this.el.web2vr.settings.scrollWindowHeight;this.el.web2vr.scroll.scrollContainer==this.el.web2vr.container&&(r=this.el.web2vr.scroll.scrollContainer.scrollHeight-this.el.web2vr.scroll.scrollContainer.clientHeight);var i,o=(1-n.detail.intersection.uv.y)*r/this.el.web2vr.settings.scale,a=function(t){if(Array.isArray(t))return e(t)}(i=this.el.web2vr.elements)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||t(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();a.shift(),this.el.pointer.object3D.position.setY(this.pointEndY+n.detail.intersection.uv.y*(this.pointStartY-this.pointEndY));var s,l=function(e){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=t(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(a);try{for(l.s();!(s=l.n()).done;)s.value.position.scrollY=o}catch(t){l.e(t)}finally{l.f()}this.el.web2vr.update()}.bind(this))},play:function(){var t=parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute("width")),e=parseFloat(this.el.web2vr.aframe.container.firstElementChild.getAttribute("height"));this.el.setAttribute("width",t/20),this.el.setAttribute("height",e),this.el.scrollbar.object3D.position.setX(t+parseFloat(this.el.getAttribute("width")/2)),this.el.scrollbar.object3D.position.setY(0-e/2),this.el.scrollbar.object3D.position.setZ(-4*this.el.web2vr.settings.layerStep),this.el.pointer.setAttribute("height",t/20),this.el.pointer.setAttribute("width",t/20),this.pointStartY=e/2-parseFloat(this.el.pointer.getAttribute("height"))/2,this.pointEndY=this.pointStartY-e+parseFloat(this.el.pointer.getAttribute("height")),this.el.pointer.object3D.position.setY(this.pointStartY),this.el.pointer.object3D.position.setZ(2*this.el.web2vr.settings.layerStep)}})},113:()=>{function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),n(3);var r=n(4),i={mode:"normal"};i.template=new r,t.exports=window.AFK=i},function(t,e,r){var i=r(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("a-keyboard",{schema:{audio:{default:!1},color:{default:"#fff"},highlightColor:{default:"#1a79dc"},dismissable:{default:!0},font:{default:"monoid"},fontSize:{default:"0.39"},locale:{default:"en"},model:{default:""},baseTexture:{default:""},keyTexture:{default:""},verticalAlign:{default:"center"}},init:function(){AFK.template.draw(n(n({},this.data),{},{el:this.el})),this.attachEventListeners()},attachEventListeners:function(){window.addEventListener("keydown",this.handleKeyboardPress),this.el.addEventListener("click",this.handleKeyboardVR)},removeEventListeners:function(){window.removeEventListener("keydown",this.handleKeyboardPress),this.el.removeEventListener("click",this.handleKeyboardVR)},handleKeyboardPress:function(t){i(t)},handleKeyboardVR:function(t){i(t,"vr")},remove:function(){this.removeEventListeners()}})},function(t,e){t.exports=function(t,e){var n,r=new Set([16,17,18,20,33,34,35,36,45,46,112,113,114,115,116,117,118,119,120,121,122,123]),i=t.key&&t.key.charCodeAt(0),o=t.key,a=t.keyCode;if("vr"===e)a=parseInt(document.querySelector("#".concat(t.target.id)).getAttribute("key-code")),o=document.querySelector("#".concat(t.target.id)).getAttribute("value");else if(r.has(t.keyCode))return;switch(a){case 9:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:"\t"}}),document.dispatchEvent(n);break;case 8:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:""}}),document.dispatchEvent(n);break;case 13:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:"\n"}}),document.dispatchEvent(n);break;case 16:AFK.template.toggleActiveMode("shift");break;case 18:AFK.template.toggleActiveMode("alt");break;case 27:this.dismissable&&(n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:""}}),document.dispatchEvent(n));break;case 32:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:" "}}),document.dispatchEvent(n);break;default:n=new CustomEvent("a-keyboard-update",{detail:{code:a,value:o}}),document.dispatchEvent(n)}if("vr"!==e){var s=document.querySelector("#a-keyboard-".concat(i))||document.querySelector("#a-keyboard-".concat(t.keyCode));s&&(s.dispatchEvent(new Event("mousedown")),setTimeout((function(){s.dispatchEvent(new Event("mouseleave"))}),80))}}},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("keyboard-button",{init:function(){var t=this,e=this.el;e.addEventListener("mousedown",(function(){e.setAttribute("material","opacity","0.7")})),e.addEventListener("mouseup",(function(){e.setAttribute("material","opacity",t.isMouseEnter?"0.9":"0")})),e.addEventListener("mouseenter",(function(){e.setAttribute("material","opacity","0.9"),self.isMouseEnter=!0})),e.addEventListener("mouseleave",(function(){e.setAttribute("material","opacity","0"),self.isMouseEnter=!1}))}})},function(e,n,r){var i=r(5);e.exports=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyboardKeys={},this.activeMode="normal"}var n,r;return n=e,r=[{key:"draw",value:function(t){for(var e in t)this[e]=t[e];this.keyboardKeys=i(t.locale),this.drawKeyboard()}},{key:"drawButton",value:function(t){var e=t.key,n=e.size.split(" ")[0],r=e.size.split(" ")[1],i=document.createElement("a-entity");i.setAttribute("position",t.position);var o=document.createElement("a-entity");o.setAttribute("geometry","primitive: plane; width: ".concat(n,"; height: ").concat(r,";")),this.keyTexture&&this.keyTexture.length>0?o.setAttribute("material","src: ".concat(this.keyTexture)):o.setAttribute("material","color: #4a4a4a; opacity: 0.9");var a=document.createElement("a-text");a.id="a-keyboard-".concat(e.code),a.setAttribute("key-code",e.code),a.setAttribute("value",e.value),a.setAttribute("align","center"),a.setAttribute("baseline",this.verticalAlign),a.setAttribute("position","0 0 0.001"),a.setAttribute("width",this.fontSize),a.setAttribute("height",this.fontSize),a.setAttribute("geometry","primitive: plane; width: ".concat(n,"; height: ").concat(r)),a.setAttribute("material","opacity: 0.0; transparent: true; color: ".concat(this.highlightColor)),a.setAttribute("color",this.color),a.setAttribute("font",this.font),a.setAttribute("shader","msdf"),a.setAttribute("negate","false"),a.setAttribute("keyboard-button",!0),a.setAttribute("class","collidable"),i.appendChild(o),i.appendChild(a),this.el.appendChild(i)}},{key:"drawKeyboard",value:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);if(this.keyboardKeys){var t=this.keyboardKeys[this.activeMode]||this.keyboardKeys.normal,e=document.createElement("a-entity"),n=.04*t.length+.004*(t.length-1)+.04;e.setAttribute("position","".concat(.26-.02," ").concat(-n/2+.02," -0.01")),e.setAttribute("geometry","primitive: plane; width: ".concat(.52,"; height: ").concat(n)),this.baseTexture&&this.baseTexture.length>0?e.setAttribute("material","src: ".concat(this.baseTexture)):e.setAttribute("material","color: #4a4a4a; side: double; opacity: 0.7"),this.el.appendChild(e);for(var r=0,i=0;i<t.length;i++)for(var o=t[i],a=0,s=0;s<o.length;s++){var l=o[s],c=this.parseKeyObjects(l);if(this.dismissable||"cancel"!==l.type){var u=c.size.split(" ")[0],d=c.size.split(" ")[1];this.drawButton({key:c,position:"".concat(a+u/2," ").concat(r-d/2," 0")}),a+=parseFloat(u)+.004,o.length===s+1&&(r-=.044)}}}}},{key:"toggleActiveMode",value:function(t){t===this.activeMode?(this.activeMode="normal",this.drawKeyboard()):(this.activeMode=t,this.drawKeyboard())}},{key:"parseKeyObjects",value:function(t){var e=t.type,n=t.value;switch(e){case"delete":return{size:"0.04 0.04 0",value:n,code:"8"};case"enter":return{size:"0.04 0.084 0",value:n,code:"13"};case"shift":return{size:"0.084 0.04 0",value:n,code:"16"};case"alt":return{size:"0.084 0.04 0",value:n,code:"18"};case"space":return{size:"".concat(.2+.016," 0.04 0"),value:n,code:"32"};case"cancel":return{size:"0.084 0.04 0",value:n,code:"24"};case"submit":return{size:"0.084 0.04 0",value:n,code:"06"};default:return{size:"0.04 0.04 0",value:n,code:n.charCodeAt(0)}}}}],r&&t(n.prototype,r),e}()},function(t,e,n){var r=n(6);t.exports=function(t){return r}},function(t,e){t.exports={name:"ms-US-International",normal:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"q",type:"standard"},{value:"w",type:"standard"},{value:"e",type:"standard"},{value:"r",type:"standard"},{value:"t",type:"standard"},{value:"y",type:"standard"},{value:"u",type:"standard"},{value:"i",type:"standard"},{value:"o",type:"standard"},{value:"p",type:"standard"},{value:"Ent",type:"enter"}],[{value:"a",type:"standard"},{value:"s",type:"standard"},{value:"d",type:"standard"},{value:"f",type:"standard"},{value:"g",type:"standard"},{value:"h",type:"standard"},{value:"j",type:"standard"},{value:"k",type:"standard"},{value:"l",type:"standard"},{value:'"',type:"standard"}],[{value:"Shift",type:"shift"},{value:"z",type:"standard"},{value:"x",type:"standard"},{value:"c",type:"standard"},{value:"v",type:"standard"},{value:"b",type:"standard"},{value:"n",type:"standard"},{value:"m",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]],shift:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"Q",type:"standard"},{value:"W",type:"standard"},{value:"E",type:"standard"},{value:"R",type:"standard"},{value:"T",type:"standard"},{value:"Y",type:"standard"},{value:"U",type:"standard"},{value:"I",type:"standard"},{value:"O",type:"standard"},{value:"P",type:"standard"},{value:"Ent",type:"enter"}],[{value:"A",type:"standard"},{value:"S",type:"standard"},{value:"D",type:"standard"},{value:"F",type:"standard"},{value:"G",type:"standard"},{value:"H",type:"standard"},{value:"J",type:"standard"},{value:"K",type:"standard"},{value:"L",type:"standard"},{value:'"',type:"standard"}],[{value:"Shift",type:"shift"},{value:"Z",type:"standard"},{value:"X",type:"standard"},{value:"C",type:"standard"},{value:"V",type:"standard"},{value:"B",type:"standard"},{value:"N",type:"standard"},{value:"M",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]],alt:[[{value:"1",type:"standard"},{value:"2",type:"standard"},{value:"3",type:"standard"},{value:"4",type:"standard"},{value:"5",type:"standard"},{value:"6",type:"standard"},{value:"7",type:"standard"},{value:"8",type:"standard"},{value:"9",type:"standard"},{value:"0",type:"standard"},{value:"<-",type:"delete"}],[{value:"~",type:"standard"},{value:"`",type:"standard"},{value:"|",type:"standard"},{value:"(",type:"standard"},{value:")",type:"standard"},{value:"^",type:"standard"},{value:"_",type:"standard"},{value:"-",type:"standard"},{value:"=",type:"standard"},{value:"!",type:"standard"},{value:"Ent",type:"enter"}],[{value:"@",type:"standard"},{value:"#",type:"standard"},{value:"$",type:"standard"},{value:"%",type:"standard"},{value:"*",type:"standard"},{value:"[",type:"standard"},{value:"]",type:"standard"},{value:"#",type:"standard"},{value:"<",type:"standard"},{value:"?",type:"standard"}],[{value:"Shift",type:"shift"},{value:":",type:"standard"},{value:";",type:"standard"},{value:"{",type:"standard"},{value:"}",type:"standard"},{value:"/",type:"standard"},{value:"\\",type:"standard"},{value:">",type:"standard"},{value:"Alt",type:"alt"}],[{value:"Cancel",type:"cancel"},{value:"",type:"space"},{value:",",type:"standard"},{value:".",type:"standard"},{value:"Submit",type:"submit"}]]}}])},523:()=>{[Element].forEach((function(t){t.prototype._addEventListener=t.prototype.addEventListener,t.prototype.addEventListener=function(t,e,n){this.eventListenerList||(this.eventListenerList={}),n=void 0!==n&&n;var r=this;if(r._addEventListener(t,e,n),r.eventListenerList[t]||(r.eventListenerList[t]=[]),r.eventListenerList[t].push({type:t,handle:e,useCapture:n,remove:function(){return r.removeEventListener(this.type,this.handle,this.useCapture),r.eventListenerList[t]}}),"eventListenerAdded"!=t&&"eventListenerRemoved"!=t){var i=new CustomEvent("eventListenerAdded",{detail:{type:t,handle:e,useCapture:n}});this.dispatchEvent(i)}},t.prototype._removeEventListener=t.prototype.removeEventListener,t.prototype.removeEventListener=function(t,e,n){this.eventListenerList||(this.eventListenerList={});var r=this;if(r.eventListenerList[t]&&(r._removeEventListener(t,e,n),r.eventListenerList[t]=r.eventListenerList[t].filter((function(t){return t&&t.handle&&e&&t.handle.toString()!==e.toString()})),0===r.eventListenerList[t].length&&delete r.eventListenerList[t],"eventListenerAdded"!=t&&"eventListenerRemoved"!=t)){var i=new CustomEvent("eventListenerRemoved",{detail:{type:t,handle:e,useCapture:n}});this.dispatchEvent(i)}}}))},996:t=>{"use strict";var e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===n}(t)}(t)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?s((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function i(t,e,n){return t.concat(e).map((function(t){return r(t,n)}))}function o(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function a(t,e){try{return e in t}catch(t){return!1}}function s(t,n,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||e,l.cloneUnlessOtherwiseSpecified=r;var c=Array.isArray(n);return c===Array.isArray(t)?c?l.arrayMerge(t,n,l):function(t,e,n){var i={};return n.isMergeableObject(t)&&o(t).forEach((function(e){i[e]=r(t[e],n)})),o(e).forEach((function(o){(function(t,e){return a(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,o)||(a(t,o)&&n.isMergeableObject(e[o])?i[o]=function(t,e){if(!e.customMerge)return s;var n=e.customMerge(t);return"function"==typeof n?n:s}(o,n)(t[o],e[o],n):i[o]=r(e[o],n))})),i}(t,n,l):r(n,l)}s.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return s(t,n,e)}),{})};var l=s;t.exports=l},738:e=>{"use strict";e.exports=t}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i={};return(()=>{"use strict";r.d(i,{default:()=>Ot}),r(523);var t=r(996),e=r.n(t);r(738),r(481),r(113);var n=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scale=600,this.position={x:0,y:2,z:-1},this.rotation={x:0,y:0,z:0},this.layerStep=5e-4,this.parentSelector=null,this.interactiveTag="vr-interactable",this.ignoreTags=["BR","SOURCE","SCRIPT","AUDIO","NOSCRIPT"],this.debug=!1,this.showClipping=!1,this.forceClipping=!1,this.experimental=!1,this.scroll=!0,this.scrollWindowHeight=800,this.createControllers=!0,this.raycasterFar=5,this.skybox=!0,this.border=!0};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r(979),r(157),r(938),r(971);var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.web2vr=e,this.hasScroll=!1,this.scrollBody=!1,this.scrollContainer=null,this.web2vr.settings.scroll&&(this.checkScrollbar(),this.hasScroll&&this.createScrollbar())}var e,n;return e=t,(n=[{key:"checkScrollbar",value:function(){var t=document.scrollingElement,e=this.web2vr.container;t.scrollHeight>t.clientHeight?(this.hasScroll=!0,this.scrollContainer=t,this.scrollBody=!0):"scroll"==e.element.style.overflow&&(this.hasScroll=!0,this.scrollContainer=e)}},{key:"createScrollbar",value:function(){this.scrollbar=document.createElement("a-entity"),this.pointer=document.createElement("a-plane"),this.pointer.setAttribute("material","shader","flat"),this.pointer.setAttribute("color","#C1C1C1"),this.plane=document.createElement("a-plane"),this.plane.setAttribute("material","shader","flat"),this.plane.setAttribute("material","side","double"),this.plane.classList.add(this.web2vr.settings.interactiveTag),this.plane.setAttribute("color","#F1F1F1"),this.plane.setAttribute("width",1),this.plane.setAttribute("vr-scrollbar",""),this.plane.web2vr=this.web2vr,this.plane.pointer=this.pointer,this.plane.scrollbar=this.scrollbar,this.plane.appendChild(this.pointer),this.scrollbar.appendChild(this.plane),this.web2vr.aframe.container.appendChild(this.scrollbar)}},{key:"update",value:function(){this.hasScroll&&("visible"==this.web2vr.container.element.style.visibility?(this.scrollbar.object3D.visible=!0,this.plane.classList.add(this.web2vr.settings.interactiveTag)):"hidden"==this.web2vr.container.element.style.visibility&&(this.scrollbar.object3D.visible=!1,this.plane.classList.remove(this.web2vr.settings.interactiveTag)))}}])&&o(e.prototype,n),t}();function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=document.getElementsByTagName("a-assets")[0];n?this.assets=n:(this.assets=document.createElement("a-assets"),e.appendChild(this.assets))}var e,n;return e=t,(n=[{key:"updateCurrentAssetId",value:function(){var t=parseInt(this.assets.getAttribute("current-id"));this.assets.getAttribute("current-id")||(this.assets.setAttribute("current-id",0),t=0),this.assets.setAttribute("current-id",t+1)}},{key:"updateCurrentAssetIdReturn",value:function(){return this.updateCurrentAssetId(),"asset-"+this.assets.getAttribute("current-id")}},{key:"getAsset",value:function(t,e){var n,r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(this.assets.getChildren());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.getAttribute("src")===t)return i.getAttribute("id")}}catch(t){r.e(t)}finally{r.f()}return this.createAsset(t,e)}},{key:"createAsset",value:function(t,e){var n=document.createElement(e);n.setAttribute("src",t),this.updateCurrentAssetId();var r="asset-"+this.assets.getAttribute("current-id");return n.setAttribute("id",r),n.setAttribute("crossorigin","Anonymous"),this.assets.appendChild(n),r}},{key:"removeAsset",value:function(t){this.assets.querySelector("#"+t).remove()}}])&&l(e.prototype,n),t}();function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r(953);var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inVR=!1,this.settings=e,this.createScene(),this.assetManager=new c(this.scene)}var e,n;return e=t,(n=[{key:"createScene",value:function(){var t=this,e=document.getElementsByTagName("a-scene");e.length>0?this.scene=e[0]:(this.scene=document.createElement("a-scene"),document.body.appendChild(this.scene),this.newScene=!0),this.settings.debug&&this.scene.setAttribute("stats",""),this.scene.setAttribute("vr-renderer",""),this.scene.addEventListener("enter-vr",function(){t.inVR=!0}.bind(this)),this.scene.addEventListener("exit-vr",function(){t.inVR=!1}.bind(this))}},{key:"createContainer",value:function(t){this.container=document.createElement("a-entity"),this.container.classList.add("vr-container"),this.container.classList.add(this.settings.interactiveTag);var e=parseFloat(window.getComputedStyle(t.container).width)*(1/this.settings.scale),n=this.settings.position.x;0==n&&(n-=e/2),this.container.object3D.position.set(n,this.settings.position.y,this.settings.position.z),this.container.setAttribute("rotation",{x:this.settings.rotation.x,y:this.settings.rotation.y,z:this.settings.rotation.z});var r=document.querySelector(this.settings.parentSelector);r?r.appendChild(this.container):(this.container.setAttribute("vr-grab-rotate-static",""),this.container.setAttribute("grabbable",""),this.container.setAttribute("stretchable",""),this.scene.appendChild(this.container)),this.container.web2vr=t}},{key:"createSky",value:function(){0==document.getElementsByTagName("a-sky").length&&this.settings.skybox&&(this.sky=document.createElement("a-sky"),this.sky.setAttribute("color","#a9f8fe"),this.scene.appendChild(this.sky))}},{key:"createControllers",value:function(){var t=this;if(!document.getElementById("mouseCursor")){var e=document.createElement("a-entity");e.id="mouseCursor",e.setAttribute("cursor","rayOrigin","mouse"),e.setAttribute("raycaster","objects: .".concat(this.settings.interactiveTag,", .collidable")),this.scene.appendChild(e)}if(this.settings.createControllers&&!document.getElementById("leftHand")){var n="objects: .".concat(this.settings.interactiveTag,", .collidable; far: ").concat(this.settings.raycasterFar),r="colliderEvent: raycaster-intersection; colliderEventProperty: els; colliderEndEvent:raycaster-intersection-cleared; colliderEndEventProperty: clearedEls; grabStartButtons: gripdown; grabEndButtons: gripup; stretchStartButtons: gripdown; stretchEndButtons: gripup",i=document.createElement("a-entity");i.id="leftHand",i.setAttribute("hand-controls","hand:left; handModelStyle: highPoly; color: #ffcccc"),i.setAttribute("laser-controls",""),i.setAttribute("raycaster",n),i.setAttribute("super-hands",r);var o=document.createElement("a-entity");o.id="rightHand",o.setAttribute("hand-controls","hand:right; handModelStyle: highPoly; color: #ffcccc"),o.setAttribute("laser-controls",""),o.setAttribute("raycaster",n),o.setAttribute("super-hands",r),this.scene.appendChild(i),this.scene.appendChild(o)}this.keyboard=document.getElementById("vr-keyboard"),this.keyboard||(this.keyboard=document.createElement("a-entity"),this.keyboard.id="vr-keyboard",this.keyboard.setAttribute("a-keyboard",""),this.keyboard.setAttribute("grabbable",""),this.scene.appendChild(this.keyboard),this.keyboard.object3D.visible=!1,this.keyboard.activeInput=null,document.addEventListener("a-keyboard-update",(function(e){if(t.keyboard.activeInput){var n=parseInt(e.detail.code),r=t.keyboard.activeInput.value;if(8==n)r=r.slice(0,-1);else{if(6==n||24==n)return t.keyboard.object3D.visible=!1,t.keyboard.object3D.position.y=1e4,t.keyboard.activeInput.element.active=!1,t.keyboard.activeInput.element.update(),void(t.keyboard.activeInput=null);[37,38,39,40].includes(n)||(r+=e.detail.value)}t.keyboard.activeInput.value=r,t.keyboard.activeInput.element.update()}})))}}])&&u(e.prototype,n),t}();function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.depth=n,this.startDepth=n,this.scale=r,this.scrollY=0,this.updatePosition(e)}var e,n;return e=t,(n=[{key:"updatePosition",value:function(t){this.domPosition=t,this.aframePosition=this.calculateAFramePosition(this.domPosition)}},{key:"calculateAFramePosition",value:function(t){var e={x:t.x+t.width/2,y:t.y+t.height/2,z:this.depth};return e.x*=this.scalingFactor,e.y*=-1*this.scalingFactor,e.width=t.width*this.scalingFactor,e.height=t.height*this.scalingFactor,e}},{key:"equalsDOMPosition",value:function(t){return this.domPosition.top==t.top&&this.domPosition.bottom==t.bottom&&this.domPosition.left==t.left&&this.domPosition.right==t.right}},{key:"scalingFactor",get:function(){return 1/this.scale}},{key:"x",get:function(){return this.aframePosition.x}},{key:"y",get:function(){return this.aframePosition.y+this.scrollY}},{key:"z",get:function(){return this.aframePosition.z}},{key:"width",get:function(){return this.aframePosition.width}},{key:"height",get:function(){return this.aframePosition.height}},{key:"xyz",get:function(){return{x:this.x,y:this.y,z:this.z}}},{key:"left",get:function(){return{x:this.x-this.width/2,y:this.y,z:this.z}}},{key:"right",get:function(){return{x:this.x+this.width/2,y:this.y,z:this.z}}},{key:"top",get:function(){return{x:this.x,y:this.y+this.height/2,z:this.z}}},{key:"bottom",get:function(){return{x:this.x,y:this.y-this.height/2,z:this.z}}}])&&h(e.prototype,n),t}();function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.listeningForMouseEvents=!1,this.resync(),this.checkEntityEvents()}var e,n;return e=t,(n=[{key:"resync",value:function(){for(var t=["click","mouseenter","mouseleave","mousedown","mouseup"],e=!1,n=0,r=t;n<r.length;n++){var i=r[n];if(this.element.domElement.eventListenerList&&this.element.domElement.eventListenerList[i]){e=!0;break}}for(var o=!1,a=0,s=["onclick","onmouseenter","onmouseleave","onmousedown","onmouseup"];a<s.length;a++){var l=s[a];if(this.element.domElement[l]){o=!0;break}}e||o?this.listeningForMouseEvents||(this.addMouseListeners(t),this.listeningForMouseEvents=!0):this.listeningForMouseEvents&&(this.removeMouseListeners(t),this.listeningForMouseEvents=!1)}},{key:"mouseEventHandler",value:function(t){var e=new MouseEvent(t.type,{view:window,bubbles:!0,cancelable:!0,target:this.element.domElement});this.element.domElement.dispatchEvent(e)}},{key:"addMouseListeners",value:function(t){var e=this;t.forEach((function(t){e.element.entity.addEventListener(t,e.mouseEventHandler.bind(e))}))}},{key:"removeMouseListeners",value:function(t){var e=this;t.forEach((function(t){e.element.entity.removeEventListener(t,e.mouseEventHandler.bind(e))}))}},{key:"checkEntityEvents",value:function(){for(var t=0,e=["click","mouseenter","mouseleave","mousedown","mouseup"];t<e.length;t++){var n=e[t];if(this.element.entity.eventListenerList&&this.element.entity.eventListenerList[n]){this.listeningForMouseEvents=!0;break}}}}])&&p(e.prototype,n),t}();function v(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.web2vr=e,this.domElement=n,this.layer=r,this.domElement.element=this,this.childElements=new Set,this.entity=null,this.visible=!0,this.domElement.classList.contains("vr-span")&&this.paddingToMargin(),this.position=new f(this.domElement.getBoundingClientRect(),r*this.web2vr.settings.layerStep,e.settings.scale),this.style=window.getComputedStyle(this.domElement),this.parentTransform="none",this.needsStartingTransformSize=!0}var e,n;return e=t,(n=[{key:"initEventHandlers",value:function(){var t=this;this.initHover(),this.mouseEventHandle=new y(this),this.domElement.addEventListener("eventListenerAdded",(function(){return t.mouseEventHandle.resync()})),this.domElement.addEventListener("eventListenerRemoved",(function(){return t.mouseEventHandle.resync()}))}},{key:"checkAnimation",value:function(){parseFloat(this.style.animationDuration)||parseFloat(this.style.transitionDuration)?this.entity.setAttribute("vr-animate",""):this.entity.removeAttribute("vr-animate")}},{key:"initHover",value:function(){var t=this,e=null;this.web2vr.hoverSelectors.has(this.domElement.tagName.toLowerCase())&&(e=this.domElement.tagName.toLowerCase());var n,r=[],i=v(this.domElement.classList);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.web2vr.hoverSelectors.has("."+o)&&r.push(o)}}catch(t){i.e(t)}finally{i.f()}var a=null;this.web2vr.hoverSelectors.has("#"+this.domElement.id)&&(a=this.domElement.id),(e||r.length>0||a)&&(this.entity.addEventListener("mouseenter",(function(){if(e&&t.domElement.classList.add(e+"hover"),r.length>0){var n,i=v(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.domElement.classList.add(o+"hover")}}catch(t){i.e(t)}finally{i.f()}}a&&t.domElement.classList.add(a+"hover"),"none"!=t.style.transform&&(t.web2vr.update(),t.hoverTransform=!0)})),this.entity.addEventListener("mouseleave",(function(){if(e&&t.domElement.classList.remove(e+"hover"),r.length>0){var n,i=v(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.domElement.classList.remove(o+"hover")}}catch(t){i.e(t)}finally{i.f()}}if(a&&t.domElement.classList.remove(a+"hover"),t.hoverTransform){t.position.depth=t.position.startDepth;var s,l=v(t.domElement.querySelectorAll("*"));try{for(l.s();!(s=l.n()).done;){var c=s.value;c.element&&(c.element.parentTransform="none",c.element.position.depth=c.element.position.startDepth)}}catch(t){l.e(t)}finally{l.f()}}})))}},{key:"paddingToMargin",value:function(){if(this.domElement.textContent.trim()){var t=this.domElement.parentElement.element.style.paddingRight;parseFloat(t)&&(this.domElement.style.marginRight=t,this.domElement.parentElement.style.paddingRight="0px")}}},{key:"init",value:function(){this.entity.element=this,this.entity.setAttribute("material","shader","flat"),this.entity.setAttribute("width",this.position.width),this.entity.setAttribute("height",this.position.height),this.initEventHandlers(),this.setupClipping()}},{key:"update",value:function(){var t=this.domElement.getBoundingClientRect();if(0==t.width||0==t.height)return this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag),void(this.position.aframePosition.y=1e3);if(this.domElement.classList.contains("vr-span")&&(this.entity.classList.remove(this.web2vr.settings.interactiveTag),"BUTTON"!=this.domElement.parentElement.tagName&&(t.width+=8,t.x-=2)),this.web2vr.scroll.hasScroll&&this.domElement==this.web2vr.container&&this.web2vr.scroll.scrollBody&&(t.height=this.web2vr.settings.scrollWindowHeight),this.position.updatePosition(t),this.checkVisible(),this.visible){if(this.style=window.getComputedStyle(this.domElement),"hidden"===this.style.visibility||"none"===this.style.display)return this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag),this.position.aframePosition.y=1e3,void this.updateBorder();this.entity.object3D.visible=!0,(!this.domElement.classList.contains("vr-span")&&(this.mouseEventHandle.listeningForMouseEvents||"INPUT"==this.domElement.tagName&&"text"==this.domElement.type)||this.domElement==this.web2vr.container)&&this.entity.classList.add(this.web2vr.settings.interactiveTag),("none"==this.style.transform||this.needsStartingTransformSize)&&(this.entity.setAttribute("width",this.position.width),this.entity.setAttribute("height",this.position.height)),this.checkAnimation();var e=this.style.opacity;this.entity.setAttribute("opacity",e),this.specificUpdate(),this.updateTransform(),this.updateClipping()}this.updateBorder()}},{key:"updateTransform",value:function(){var t=this.style.transform;if("none"==t)t=this.parentTransform;else{var e,n=v(this.domElement.querySelectorAll("*"));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.element&&(r.element.parentTransform=t)}}catch(t){n.e(t)}finally{n.f()}}if("none"!=t){this.needsStartingTransformSize=!1;var i=t.split("(")[0],o=t.split("(")[1];o=(o=(o=o.split(")")[0]).split(",")).map((function(t){return parseFloat(t)}));var a=null;"matrix"==i?a=(new THREE.Matrix4).fromArray([o[0],o[1],0,0,-o[2],o[3],0,0,0,0,1,0,o[4],o[5],0,1]):"matrix3d"==i&&(o[4]*=-1,o[9]*=-1,a=(new THREE.Matrix4).fromArray(o));var s=new THREE.Vector3,l=new THREE.Quaternion,c=new THREE.Vector3;if(a.decompose(s,l,c),this.position.domPosition.x+=s.x,this.position.domPosition.y+=s.y,0!=s.z&&(this.position.depth=s.z*this.position.scalingFactor+this.position.startDepth),this.entity.object3D.rotation.setFromRotationMatrix(a),"none"==this.parentTransform){var u=a.elements,d=Math.sqrt(u[0]*u[0]+u[1]*u[1]),h=Math.sqrt(u[5]*u[5]+u[4]*u[4]);"INPUT"!=this.domElement.tagName||"radio"!=this.domElement.type&&"checkbox"!=this.domElement.type?this.entity.object3D.scale.set(d,h,1):this.entity.object3D.scale.set(d/2,h/2,1)}}this.entity.object3D.position.set(this.position.x,this.position.y,this.position.z)}},{key:"specificUpdate",value:function(){}},{key:"updateBorder",value:function(){if(this.web2vr.settings.border){var t=parseFloat(this.style.borderTopWidth);(t||this.borderWidth)&&this.entity.object3D.visible?(this.entity.setAttribute("vr-border","width:".concat(t,"; color:").concat(this.style.borderTopColor,";")),this.entity.components["vr-border"].updateBorder()):this.entity.components["vr-border"]&&this.entity.removeAttribute("vr-border")}}},{key:"rotateNormal",value:function(t){var e=(new THREE.Matrix3).getNormalMatrix(this.web2vr.aframe.container.object3D.matrixWorld);return t.clone().applyMatrix3(e).normalize()}},{key:"getClippingContext",value:function(){var t=null;if(this.domElement.parentNode&&this.domElement.parentNode.element&&this.domElement.parentNode.element.clippingContext)t=this.domElement.parentNode.element.clippingContext;else if((this.style.overflow&&"hidden"==this.style.overflow||this.web2vr.scroll.hasScroll&&this.domElement==this.web2vr.container||this.web2vr.settings.forceClipping&&this.domElement==this.web2vr.container)&&"svg"!=this.domElement.tagName){var e={};e.authority=this,e.bottom=new THREE.Plane(this.rotateNormal(new THREE.Vector3(0,1,0))),e.top=new THREE.Plane(this.rotateNormal(new THREE.Vector3(0,-1,0))),e.left=new THREE.Plane(this.rotateNormal(new THREE.Vector3(1,0,0))),e.right=new THREE.Plane(this.rotateNormal(new THREE.Vector3(-1,0,0))),e.planes=[e.bottom,e.top,e.left,e.right],t=e}return t}},{key:"setupClipping",value:function(){var t=this,e=this.getClippingContext();if(e){this.clippingContext=e;var n=this.entity.object3D;if(!n||!n.children||!n.children.length>0||!n.children[0].material)return;n.children[0].material.clippingPlanes=e.planes,setTimeout((function(){t.updateClipping()}),200)}}},{key:"updateClipping",value:function(){if(this.clippingContext&&this.clippingContext.authority==this){var t=this.entity.object3D.position,e=t.clone().add(new THREE.Vector3(0,-1,0).multiplyScalar(this.position.height/2)),n=t.clone().add(new THREE.Vector3(0,1,0).multiplyScalar(this.position.height/2)),r=t.clone().add(new THREE.Vector3(-1,0,0).multiplyScalar(this.position.width/2)),i=t.clone().add(new THREE.Vector3(1,0,0).multiplyScalar(this.position.width/2)),o=this.web2vr.aframe.container.object3D.localToWorld(e.clone()),a=this.web2vr.aframe.container.object3D.localToWorld(n.clone()),s=this.web2vr.aframe.container.object3D.localToWorld(r.clone()),l=this.web2vr.aframe.container.object3D.localToWorld(i.clone());if(this.clippingContext.bottom.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0,1,0)),o).normalize(),this.clippingContext.top.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(0,-1,0)),a).normalize(),this.clippingContext.left.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(1,0,0)),s).normalize(),this.clippingContext.right.setFromNormalAndCoplanarPoint(this.rotateNormal(new THREE.Vector3(-1,0,0)),l).normalize(),this.web2vr.settings.showClipping){if(!this.clippingPlaneHelpers){this.clippingPlaneHelpers=[];var c,u=v(this.clippingContext.planes);try{for(u.s();!(c=u.n()).done;){var d=c.value,h=new THREE.MeshBasicMaterial({color:58173,side:THREE.DoubleSide}),f=new THREE.PlaneGeometry(200*this.position.scalingFactor,200*this.position.scalingFactor),p=new THREE.Mesh(f,h);p.debugPlane=d,this.clippingPlaneHelpers.push(p);var y=new THREE.AxesHelper(5);p.add(y)}}catch(t){u.e(t)}finally{u.f()}var m,b=v(this.clippingPlaneHelpers);try{for(b.s();!(m=b.n()).done;){var g=m.value;this.web2vr.aframe.scene.object3D.add(g)}}catch(t){b.e(t)}finally{b.f()}}var E,w=v(this.clippingPlaneHelpers);try{for(w.s();!(E=w.n()).done;){var _=E.value;_.visible=!0;var A=new THREE.Vector3;this.entity.object3D.getWorldPosition(A);var k=new THREE.Vector3;_.debugPlane.projectPoint(A,k),_.position.set(k.x,k.y,k.z);var S=k.clone().add(_.debugPlane.normal.clone().multiplyScalar(-1));_.lookAt(S)}}catch(t){w.e(t)}finally{w.f()}}else if(this.clippingPlaneHelpers){var x,O=v(this.clippingPlaneHelpers);try{for(O.s();!(x=O.n()).done;)x.value.visible=!1}catch(t){O.e(t)}finally{O.f()}}}}},{key:"checkVisible",value:function(){if(this.clippingContext){var t=this.clippingContext.authority;this.position.bottom.y>t.position.top.y||this.position.top.y<t.position.bottom.y?(this.visible=!1,this.entity.object3D.visible=!1,this.domElement.classList.contains("vr-span")||this.entity.classList.remove(this.web2vr.settings.interactiveTag)):(this.visible=!0,this.entity.object3D.visible=!0,(!this.domElement.classList.contains("vr-span")&&this.mouseEventHandle.listeningForMouseEvents||this.domElement==this.web2vr.container)&&this.entity.classList.add(this.web2vr.settings.interactiveTag))}}}])&&b(e.prototype,n),t}();function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"isUrl",value:function(t){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)}},{key:"clamp",value:function(t,e,n){return Math.min(n,Math.max(e,t))}}],null&&E(e.prototype,null),n&&E(e,n),t}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e){return k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},k(t,e)}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=S(r);if(i){var n=S(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).textOnly=i,r.entity=document.createElement("a-plane"),"A"==r.domElement.tagName&&r.entity.addEventListener("click",(function(){console.log("Link clicked!",r.domElement.click())})),r.textOnly||(r.domElement==r.web2vr.container&&r.entity.setAttribute("material","side","double"),r.expImageId=null,r.oldBackgroundImage=null,r.oldDomPosition=null),r}return e=a,(n=[{key:"specificUpdate",value:function(){var t=this;if(!this.textOnly){var e=this.style.backgroundColor,n=this.style.backgroundImage;if("none"!=n)if(this.web2vr.settings.experimental){if(n!=this.oldBackgroundImage||this.oldDomPosition&&!this.position.equalsDOMPosition(this.oldDomPosition)){var r=this.domElement.id,i=!1;r||(i=!0,r="html2canvas-"+this.web2vr.html2canvasIDcounter++,this.domElement.id=r),html2canvas(this.domElement,{onclone:function(e){var n=document.createElement("style");e.head.appendChild(n),n.sheet.insertRule("\n                    #".concat(r," {\n                        opacity: 1;\n                    }")),n.sheet.insertRule("\n                    #".concat(r," {\n                        color: transparent;\n                    }")),n.sheet.insertRule("\n                    #".concat(r," > * {\n                        display:none\n                    }")),n.sheet.insertRule("\n                    #".concat(r," > .vr-span {\n                        display:block\n                    }")),i&&t.domElement.removeAttribute("id")}}).then((function(e){t.expImageId&&t.web2vr.aframe.assetManager.removeAsset(t.expImageId),t.expImageId=t.web2vr.aframe.assetManager.getAsset(e.toDataURL(),"img"),t.entity.setAttribute("material","src: #"+t.expImageId)})),this.oldBackgroundImage=n}}else w.isUrl(n)&&(n=n.substring(n.lastIndexOf('("')+2,n.lastIndexOf('")')),this.entity.setAttribute("material","src: #"+this.web2vr.aframe.assetManager.getAsset(n,"img")),this.entity.setAttribute("material","transparent",!0));else"rgba(0, 0, 0, 0)"==e?this.entity.setAttribute("material","visible",!1):(this.entity.setAttribute("material","visible",!0),this.entity.setAttribute("color",e),this.updateOpacity());this.oldDomPosition=this.position.domPosition}}},{key:"updateOpacity",value:function(){var t=parseFloat(this.style.backgroundColor.split(",")[3]);if(t){var e=t,n=this.style.opacity;e<n&&(n=t,e=this.style.opacity),this.entity.setAttribute("opacity",e-(e-n))}}}])&&A(e.prototype,n),a}(g);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e,n){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},T(t,e,n||t)}function j(t,e){return j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},j(t,e)}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=P(r);if(i){var n=P(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==O(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n,!1)).entity.setAttribute("text","value",""),r.textValue=null,r}return e=a,(n=[{key:"setupClipping",value:function(){var t=this.getClippingContext();if(t){this.clippingContext=t;var e=this.entity.components.text.material;e.fragmentShader="\n            precision highp float;\n            uniform bool negate;\n            uniform float alphaTest;\n            uniform float opacity;\n            uniform sampler2D map;\n            uniform vec3 color;\n            in vec2 vUV;\n            out vec4 fragColor;\n            float median(float r, float g, float b) {\n                return max(min(r, g), min(max(r, g), b));\n            }\n            #define BIG_ENOUGH 0.001\n            #define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\n            \n            // clipping_planes_pars_fragment converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n                in vec3 vClipPosition;\n                uniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n            #endif\n            \n            void main() {\n                // compatible with glsl 3\n                #include <clipping_planes_fragment>\n\n                vec3 sampleColor = texture(map, vUV).rgb;\n                if (negate) { sampleColor = 1.0 - sampleColor; }\n                float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n                float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n                float dscale = 0.353505;\n                vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));\n                float isBigEnough = max(abs(duv.x), abs(duv.y));\n                // Do modified alpha test.\n                if (isBigEnough > BIG_ENOUGH) {\n                    float ratio = BIG_ENOUGH / isBigEnough;\n                    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n                }\n                // Do modified alpha test.\n                if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n                fragColor = vec4(color.xyz, alpha * opacity);\n            }",e.vertexShader="\n            in vec2 uv;\n            in vec3 position;\n            uniform mat4 projectionMatrix;\n            uniform mat4 modelViewMatrix;\n            out vec2 vUV;\n\n            // clipping_planes_pars_vertex converted to glsl 3\n            #if NUM_CLIPPING_PLANES > 0\n\t            out vec3 vClipPosition;\n            #endif\n\n            void main(void) {\n                // compatible with glsl 3\n                #include <begin_vertex>\n\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                vUV = uv;\n\n                // compatible with glsl 3\n                #include <project_vertex>\n                #include <clipping_planes_vertex>\n\n            }",e.clipping=!0,e.clippingPlanes=t.planes,this.updateClipping()}}},{key:"updateTextAlignment",value:function(){var t=this.style.textAlign;["left","right","center"].includes(t)||(t="left"),this.entity.setAttribute("text","align",t);var e=this.entity.components.text;"normal"!=this.style.lineHeight&&void 0!==e.currentFont&&this.entity.setAttribute("text","lineHeight",e.currentFont.common.lineHeight+parseFloat(this.style.lineHeight))}},{key:"updateTextSize",value:function(){var t=parseFloat(this.style.fontSize),e=this.position.width,n=e/this.position.scalingFactor*42/t;n*=1.107,this.entity.setAttribute("text","wrapPixels",n),this.entity.setAttribute("text","width",e)}},{key:"updateTextColor",value:function(){var t=this.domElement.parentElement.element.style.opacity;this.entity.setAttribute("text","opacity",t);var e=this.style.color;this.entity.setAttribute("text","color",e)}},{key:"updateText",value:function(){this.textValue=this.domElement.textContent.replace(/\s{2,}/g," ")}},{key:"specificUpdate",value:function(){T(P(a.prototype),"specificUpdate",this).call(this),this.updateTextSize(),this.updateTextAlignment(),this.updateText(),this.entity.setAttribute("text","value",this.textValue),this.updateTextColor()}}])&&C(e.prototype,n),a}(x);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function M(t,e){return M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},M(t,e)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=F(r);if(i){var n=F(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==L(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).currentSrc=null,r.changed=!1,r.entity=document.createElement("a-image"),r.entity.setAttribute("material","side","front"),r.loaded=!1,r.domElement.addEventListener("load",(function(){r.loaded=!0,r.changed&&(r.changed=!1,r.web2vr.update())})),r}return e=a,(n=[{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.entity.setAttribute("id","IMAGE_"+e),/\.(gif)$/i.test(t)?(this.entity.setAttribute("material","shader","gif"),this.entity.setAttribute("material","src","#"+e)):(this.entity.setAttribute("material","shader","flat"),this.entity.setAttribute("src","#"+e))}},{key:"specificUpdate",value:function(){var t=this.domElement.getAttribute("src");t!=this.currentSrc&&(this.currentSrc&&(this.loaded=!1,this.changed=!0),this.currentSrc=t,this.updateImage(this.currentSrc))}}])&&I(e.prototype,n),a}(g);function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function U(t,e){return U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},U(t,e)}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=B(r);if(i){var n=B(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==H(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).entity=document.createElement("a-video"),r.video360=document.createElement("a-videosphere"),r.web2vr.aframe.scene.appendChild(r.video360),r.createClickEvent(),r.domElement.addEventListener("play",(function(){r.domElement.hasAttribute("vr")&&r.video360.components.material.material.map.image.play()})),r.domElement.addEventListener("pause",(function(){r.domElement.hasAttribute("vr")&&r.video360.components.material.material.map.image.pause()})),r}return e=a,(n=[{key:"createClickEvent",value:function(){var t=this;this.domElement.addEventListener("click",(function(){t.domElement.paused?t.domElement.play():t.domElement.pause()}))}},{key:"specificUpdate",value:function(){this.domElement.currentSrc;var t=this.domElement.id;if(t||(t=this.web2vr.aframe.assetManager.updateCurrentAssetIdReturn(),this.domElement.id=t),this.domElement.hasAttribute("vr")){this.video360.object3D.visible=!0,this.video360.classList.add(this.web2vr.settings.interactiveTag),this.entity.object3D.visible=!1,this.entity.classList.remove(this.web2vr.settings.interactiveTag),this.video360.setAttribute("src","#"+t);var e=this.domElement.getAttribute("vr");this.video360.object3D.rotation.y=e?THREE.MathUtils.degToRad(e):0}else this.video360.object3D.visible=!1,this.video360.classList.remove(this.web2vr.settings.interactiveTag),this.entity.object3D.visible=!0,this.entity.classList.add(this.web2vr.settings.interactiveTag),this.entity.setAttribute("src","#"+t)}}])&&N(e.prototype,n),a}(g);function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},K(t,e)}function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function q(t){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},q(t)}var Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=q(r);if(i){var n=q(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?W(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).borderColor=new THREE.Color(0),r.borderWidth=1,r.entity=document.createElement("a-plane"),r.domElement.addEventListener("click",function(){r.specificUpdate()}.bind(W(r))),r}return e=a,(n=[{key:"specificUpdate",value:function(){this.domElement.checked?this.entity.setAttribute("color","#0075FF"):this.entity.setAttribute("color","#FFFFFF")}}])&&G(e.prototype,n),a}(g);function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e){return Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Q(t,e)}function Z(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}var tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=J(r);if(i){var n=J(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?Z(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).borderColor=new THREE.Color(0),r.borderWidth=1,r.entity=document.createElement("a-circle"),r.domElement.addEventListener("click",function(){r.web2vr.update()}.bind(Z(r))),r}return e=a,(n=[{key:"specificUpdate",value:function(){this.entity.setAttribute("radius",this.position.width/2),this.domElement.checked?this.entity.setAttribute("color","#0075FF"):this.entity.setAttribute("color","#FFFFFF")}}])&&X(e.prototype,n),a}(g);function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rt(t,e,n){return rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ot(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},rt(t,e,n||t)}function it(t,e){return it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},it(t,e)}function ot(t){return ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ot(t)}var at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ot(r);if(i){var n=ot(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).borderColor=new THREE.Color(0),r.borderWidth=1,r.active=!1,r.domElement.addEventListener("input",(function(){return r.update()})),r.entity.addEventListener("click",(function(){var t=r.web2vr.aframe.scene.camera.parent,e=r.web2vr.aframe.keyboard.object3D;e.position.copy(t.position),e.rotation.copy(t.rotation),e.rotation.z=0,e.rotation.x=THREE.MathUtils.degToRad(-30),e.translateX(-.24),e.translateY(-.1),e.translateZ(-.6),e.visible=!0,r.web2vr.aframe.keyboard.activeInput&&(r.web2vr.aframe.keyboard.activeInput.element.active=!1,r.web2vr.aframe.keyboard.activeInput.element.web2vr.update()),r.active=!0,r.web2vr.aframe.keyboard.activeInput=r.domElement,r.web2vr.update()})),r}return e=a,(n=[{key:"updateText",value:function(){var t=this.domElement.value;this.textValue=t||this.domElement.placeholder}},{key:"updateTextColor",value:function(){this.domElement.value?rt(ot(a.prototype),"updateTextColor",this).call(this):this.entity.setAttribute("text","color","#999"),this.active&&this.entity.setAttribute("color","#ffffcc")}}])&&nt(e.prototype,n),a}(R);function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e){return ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ct(t,e)}function ut(t){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ut(t)}var dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ut(r);if(i){var n=ut(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==st(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).borderColor=new THREE.Color(0),r.borderWidth=1,r}return e=a,(n=[{key:"updateTextPadding",value:function(){}},{key:"updateText",value:function(){"INPUT"==this.domElement.tagName&&(this.textValue=this.domElement.value.replace(/\s{2,}/g," "))}}])&&lt(e.prototype,n),a}(R);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e){return pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pt(t,e)}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}var vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=yt(r);if(i){var n=yt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).imageId=null,r.entity=document.createElement("a-image"),r}return e=a,(n=[{key:"svgToImage",value:function(){var t=this,e=(new XMLSerializer).serializeToString(this.domElement),n=document.createElement("canvas"),r=n.getContext("2d");n.width=2*this.position.domPosition.width,n.height=2*this.position.domPosition.height;var i=self.URL||self.webkitURL||self,o=new Image,a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),s=i.createObjectURL(a);o.onload=function(){t.domElement.style.width?r.drawImage(o,0,0,2*n.width,2*n.height):r.drawImage(o,0,0,n.width,n.height),i.revokeObjectURL(s),t.updateImage(n.toDataURL()),n.remove()},o.src=s}},{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.imageId&&this.imageId!=e&&this.web2vr.aframe.assetManager.removeAsset(this.imageId),this.entity.setAttribute("id","IMAGE_"+e),this.entity.setAttribute("src","#"+e),this.imageId=e}},{key:"specificUpdate",value:function(){this.svgToImage()}}])&&ft(e.prototype,n),a}(g);function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,e){return gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},gt(t,e)}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}var wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gt(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Et(r);if(i){var n=Et(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==mt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this,t,e,n)).imageId=null,r.entity=document.createElement("a-image"),r}return e=a,(n=[{key:"updateImage",value:function(t){var e=this.web2vr.aframe.assetManager.getAsset(t,"img");this.imageId&&this.imageId!=e&&this.web2vr.aframe.assetManager.removeAsset(this.imageId),this.entity.setAttribute("id","IMAGE_"+e),this.entity.setAttribute("src","#"+e),this.imageId=e}},{key:"specificUpdate",value:function(){this.updateImage(this.domElement.toDataURL())}}])&&bt(e.prototype,n),a}(g);function _t(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=kt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function At(t){return function(t){if(Array.isArray(t))return St(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||kt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t,e){if(t){if("string"==typeof t)return St(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(t,e):void 0}}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ot=function(){function t(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r.nodeType==Node.ELEMENT_NODE?this.container=r:this.container=document.querySelector(r),this.settings=e()(new n,i,{arrayMerge:function(t,e){return[].concat(At(t),At(e))}}),this.aframe=new d(this.settings),this.elements=new Set,this.hoverSelectors=new Set,this.observer=null,this.observerConfig={childList:!0,subtree:!0,characterData:!0,attributes:!0},this.updating=!1,this.html2canvasIDcounter=0}var r,i;return r=t,i=[{key:"findHoverCss",value:function(){try{for(var t=0,e=At(document.styleSheets);t<e.length;t++)for(var n=e[t],r=0,i=At(n.cssRules);r<i.length;r++){var o=i[r];if(o instanceof CSSStyleRule){var a,s=_t(o.selectorText.split(","));try{for(s.s();!(a=s.n()).done;){var l=a.value.split(":");if("hover"==l[1]){var c=l[0].replace(/\s/g,"");"."==c[0]?o.selectorText+=", ".concat(c,"hover"):"#"==c[0]?o.selectorText+=", .".concat(c.substr(1),"hover"):o.selectorText+=", .".concat(c,"hover"),this.hoverSelectors.add(c)}}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){console.error(t)}}},{key:"generateStyleDefs",value:function(t){for(var e="",n=document.styleSheets,r=0;r<n.length;r++)for(var i=n[r].cssRules,o=0;o<i.length;o++){var a=i[o];if(a.style){var s=a.selectorText;t.querySelectorAll(s).length&&(e+=s+" { "+a.style.cssText+" }\n")}}var l=document.createElement("style");l.setAttribute("type","text/css"),l.innerHTML=e;var c=document.createElement("defs");c.appendChild(l),t.insertBefore(c,t.firstChild)}},{key:"start",value:function(){this.findHoverCss(),this.aframe.scene.hasLoaded?this.init():this.aframe.scene.addEventListener("loaded",this.init(),{once:!0})}},{key:"init",value:function(){this.aframe.createContainer(this),this.aframe.createSky(),this.aframe.createControllers(),this.convertToVR(),this.scroll=new a(this),this.allLoadedUpdate()}},{key:"allLoadedUpdate",value:function(){var t=this,e=setInterval((function(){var n,r=!0,i=_t(t.elements);try{for(i.s();!(n=i.n()).done;){var o=n.value;o instanceof D&&!o.loaded&&(r=!1)}}catch(t){i.e(t)}finally{i.f()}r&&(t.update(),clearInterval(e))}),100)}},{key:"addElement",value:function(t,e,n){if(this.settings.ignoreTags.includes(t.tagName)||t.classList&&t.classList.contains("vr-span"))return null;var r=null;if(t.nodeType==Node.TEXT_NODE&&t.nodeValue.trim()){var i=document.createElement("span");i.classList.add("vr-span"),i.textContent=t.textContent,this.observer&&this.observer.disconnect(),t.replaceWith(i),this.observer&&this.observer.observe(this.container,this.observerConfig),r=new R(this,i,n)}else if("VIDEO"==t.tagName)r=new z(this,t,n);else if("IMG"==t.tagName)r=new D(this,t,n);else if("svg"==t.tagName)r=new vt(this,t,n);else if("CANVAS"==t.tagName)r=new wt(this,t,n);else if("BUTTON"==t.tagName)r=new dt(this,t,n);else if("TEXTAREA"==t.tagName)r=new at(this,t,n);else if("INPUT"==t.tagName){var o=t.getAttribute("type");if("checkbox"==o)r=new Y(this,t,n);else if("radio"==o)r=new tt(this,t,n);else if(["text","email","number","password","search","tel","url"].includes(o))r=new at(this,t,n);else{if(!["button","submit","reset"].includes(o))return;r=new dt(this,t,n)}}else{if(t.nodeType!=Node.ELEMENT_NODE)return;r=new x(this,t,n)}return this.elements.add(r),this.aframe.container.appendChild(r.entity),this.settings.debug&&console.log("Added element",r),r.entity.addEventListener("play",(function(t){e&&e.childElements.add(r),r.init(),r.update()}),{once:!0}),r}},{key:"removeElement",value:function(t){this.aframe.container.removeChild(t.entity),this.elements.delete(t);var e,n=_t(t.childElements);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.removeElement(r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"addElementChildren",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"svg"==t.tagName&&this.generateStyleDefs(t);var r=this.addElement(t,e,n);if(r&&!(r instanceof vt)&&t.childNodes&&t.childNodes.length>0){n++;var i,o=_t(t.childNodes);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.addElementChildren(a,r,n)}}catch(t){o.e(t)}finally{o.f()}}}},{key:"convertToVR",value:function(){var t=this;this.addElementChildren(this.container),this.observer=new MutationObserver((function(e){var n,r=_t(e);try{for(r.s();!(n=r.n()).done;){var i,o=n.value,a=!1,s=_t(o.removedNodes);try{for(s.s();!(i=s.n()).done;){var l=i.value;l.nodeType!=Node.TEXT_NODE||l.nodeValue.trim()?t.removeElement(l.element):a=!0}}catch(t){s.e(t)}finally{s.f()}var c,u=_t(o.addedNodes);try{for(u.s();!(c=u.n()).done;){var d=c.value;t.addElementChildren(d,o.target.element,o.target.element.layer+1)}}catch(t){u.e(t)}finally{u.f()}a||(o.addedNodes.length>0?t.allLoadedUpdate():t.update())}}catch(t){r.e(t)}finally{r.f()}})),this.observer.observe(this.container,this.observerConfig)}},{key:"update",value:function(){if(this.updating=!0,this.updating){try{var t,e=_t(this.elements);try{for(e.s();!(t=e.n()).done;)t.value.update()}catch(t){e.e(t)}finally{e.f()}}catch(t){console.error(t)}this.scroll.update(),this.updating=!1}}}],i&&xt(r.prototype,i),t}()})(),i.default})()));